@model IEnumerable<Model1.DTO.ThongkephieutiemQuanDTO>
@{
    ViewBag.Title = "Index1";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

@section header{
    <link rel="stylesheet" href="~/Assets/Admin/css/thuan-main.css">
    <link rel="stylesheet" href="~/Content/themes/base/font/fontawesome-5.15.1/css/all.css">
    <style>
        .table-responsive {
            height: 288px;
        }


        html {
            scroll-behavior: smooth;
        }

        .lable-thuan {
            margin-left: 13px;
            box-sizing: border-box;
            flex-wrap: nowrap
        }

        .sroll-bottom {
            top: calc(50% - 0px);
            background: #f53d68;
        }

        thead {
            background-color: #ccc;
        }

        .alert {
            position: unset;
        }

        input {
            position: unset;
        }

        .red-row {
            background-color: tomato !important;
        }

        .yellow-row {
            background-color: yellow !important;
        }

        .table {
            color: black;
        }

        .container-fluid {
            color: black;
        }

        .table-bordered td {
            border-style: solid;
            border-width: 1px;
            border-color: black;
        }

        .table-bordered th {
            border-style: solid;
            border-width: 1px;
            border-color: black;
        }

        thead {
            background-color: #ccc;
            font-weight: bold;
        }

        table {
            text-align: center;
            background-color: aliceblue;
        }

        .table-bordered thead td, .table-bordered thead th {
            border-bottom-width: 1px;
            border-bottom-color: black;
        }

        .table-hover tbody tr:hover {
            color: #FF6633;
            background-color: #EEE;
        }

        .table-hover tbody .red-row:hover {
            color: white;
        }

        .table-hover tbody .yellow-row:hover {
            color: #FF6633;
        }

        .thuan-body-content {
            padding: 10px;
            box-shadow: 0 .15rem 1.75rem 0 rgba(58,59,69,.15) !important;
            background-color: white;
            border-radius: 5px;
            border-top-color: #FACE9C;
            border-style: solid;
            border-right-color: white;
            border-left-color: white;
            border-bottom-color: white
        }
    </style>
    <b class="panel-heading" style="color:black; font-size:x-large">
        Thống kê số liệu tiêm chủng
    </b>
}

@{
    DateTime date;
    date = DateTime.Today;
}

<div class="row">

    <div class="col-lg-pull-3 thuan-body-content">

        @{
            var c = DateTime.Now;
            var d = DateTime.Now;
        }
        @using (Html.BeginForm("Index", "Thongkephieutiem", FormMethod.Post))
        {
            <div class="row form-group">
                <div class="col-lg-12" style="display:flex">
                    @if (ViewBag.Maquyen == "n_account" || ViewBag.Maquyen == "admin")
                    {
                        <select name="khuvuc" id="khuvuc" style="margin-right:18px;height:35px;width:175px">
                            <option value="tq">Toàn quốc</option>
                            <option value="ttp">Tỉnh/Thành phố</option>
                        </select>
                    }

                    @if (ViewBag.Maquyen == "c_account")
                    {
                        <select name="khuvuc" id="khuvuc" style="margin-right:18px;height:35px;width:175px">
                            <option value="ttp">Tỉnh/Thành phố</option>
                            <option value="qh">Quận/Huyện</option>
                        </select>
                    }

                    @if (ViewBag.Maquyen == "d_account")
                    {
                        <select name="khuvuc" id="khuvuc" style="margin-right:18px;height:35px;width:175px">
                            <option value="qh">Quận/Huyện</option>
                            <option value="ptx">Phường/Thị xã</option>
                        </select>
                    }

                    @if (ViewBag.Maquyen == "w_account")
                    {
                        <select name="khuvuc" id="khuvuc" style="margin-right:18px;height:35px;width:175px">
                            <option value="ptx">Phường/Thị xã</option>
                            <option value="dt">Điểm tiêm</option>
                        </select>
                    }

                    <br><br>
                    <div class="form-group" style="display: flex ;  width:100%;align-items:center">
                        Từ:
                        <input type="date" id="a" value="@TempData["a"]" class="form-control" style="width:175px; margin:0 8px" name="a" />
                        Đến
                        <input type="date" id="b" value="@TempData["b"]" class="form-control" style="width:175px; margin:0 8px" name="b" />
                        <button type="submit" class="btn btn-primary">Thống kê</button>
                        <a class="Button" href="@Url.Action("ExportToExcel","Thongkephieutiem")">Xuất Excel</a>
                    </div>
                    <br><br>
                </div>
            </div>
        }

        @{
            int tongslasta1 = 0; int tongslasta2 = 0; int tongslastra3 = 0; int tongslpfi1 = 0; int tongslpfi2 = 0; int tongslpfi3 = 0;
            int tongslvero1 = 0; int tongslvero2 = 0; int tongslvero3 = 0; int tongsl = 0; int tongsltcnhe = 0; int tongsltcnang = 0;
        }

        @foreach (var item in Model)
        {
            tongslasta1 += item.SLastra1; tongslasta2 += item.SLastra2; tongslastra3 += item.SLastra3; tongslpfi1 += item.SLpfi1; tongslpfi2 += item.SLpfi2;
            tongslpfi3 += item.SLpfi3; tongslvero1 += item.SLvero1; tongslvero2 += item.SLvero2; tongslvero3 += item.SLvero3;
            tongsl += item.SLtiem; tongsltcnhe += item.SLtcnhe; tongsltcnang += item.SLtcnang;
        }

        <div class="section group">
            <b class="panel-heading" style="color:coral; font-size:large">
                Báo cáo số liệu các địa phương
            </b>
            <hr />

            @if (Model.Count() > 0)
            {

                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th rowspan="3" style="width:20%;align-items:center">Tên khu vực tiêm</th>
                                <th colspan="9" style="text-align:center">Miễn dịch cơ bản</th>
                                <th rowspan="3" style="width:20%;align-items:center">Số người đủ 3 mũi</th>
                                <th colspan="2">Phản ứng sau tiêm</th>
                            </tr>

                            <tr>
                                <th colspan="3">AstraZeneca</th>
                                <th colspan="3">Pfizer </th>
                                <th colspan="3">Vero Cell</th>
                                <th rowspan="2">Nhẹ</th>
                                <th rowspan="2">Nghiêm trọng </th>
                            </tr>

                            <tr>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in Model)
                            {
                                <tr id="row_@item.Madiemtiem">
                                    <td>@item.Madiemtiem</td>
                                    <td>@item.SLastra1</td>
                                    <td>@item.SLastra2</td>
                                    <td>@item.SLastra3</td>
                                    <td>@item.SLpfi1</td>
                                    <td>@item.SLpfi2</td>
                                    <td>@item.SLpfi3</td>
                                    <td>@item.SLvero1</td>
                                    <td>@item.SLvero2</td>
                                    <td>@item.SLvero3</td>
                                    <td>@item.SLtiem</td>
                                    <td>@item.SLtcnhe</td>
                                    <td>@item.SLtcnang</td>

                                </tr>
                            }
                        </tbody>

                        <tfoot>
                            <tr>
                                <td>Tổng</td>
                                <td>@Html.Raw(tongslasta1)</td>
                                <td>@Html.Raw(tongslasta2)</td>
                                <td>@Html.Raw(tongslastra3)</td>
                                <td>@Html.Raw(tongslpfi1)</td>
                                <td>@Html.Raw(tongslpfi2)</td>
                                <td>@Html.Raw(tongslpfi3)</td>
                                <td>@Html.Raw(tongslvero1)</td>
                                <td>@Html.Raw(tongslvero2)</td>
                                <td>@Html.Raw(tongslvero3)</td>
                                <td>@Html.Raw(tongsl)</td>
                                <td>@Html.Raw(tongsltcnhe)</td>
                                <td>@Html.Raw(tongsltcnang)</td>
                            </tr>
                        </tfoot>

                    </table>

                </div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th rowspan="3" style="width:20%;align-items:center">Tên khu vực tiêm</th>
                                <th colspan="9" style="text-align:center">Miễn dịch cơ bản</th>
                                <th rowspan="3" style="width:20%;align-items:center">Số người đủ 3 mũi</th>
                                <th colspan="2">Phản ứng sau tiêm</th>
                            </tr>

                            <tr>
                                <th colspan="3">AstraZeneca</th>
                                <th colspan="3">Pfizer </th>
                                <th colspan="3">Vero Cell</th>
                                <th rowspan="2">Nhẹ</th>
                                <th rowspan="2">Nghiêm trọng </th>
                            </tr>

                            <tr>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                                <th>1</th>
                                <th>2</th>
                                <th>3</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div class="alert alert-warning" style="width:210px; margin-top: -138px;">Chưa có dữ liệu</div>
            }
        </div>

    </div>

</div>